<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>WORKS | SHIVATEJA</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Syncopate:wght@400;700&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --c-accent: #00f3ff;
            --c-secondary: #ff0055;
            --c-dark: #050505;
            --c-white: #ffffff;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            background: var(--c-dark); 
            color: var(--c-white); 
            font-family: 'Rajdhani', sans-serif; 
            overflow: hidden; 
            height: 100vh;
            width: 100vw;
            overscroll-behavior: none;
        }

        /* --- UI LAYER --- */
        #ui-layer {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 10;
            pointer-events: none;
            padding: 30px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            mix-blend-mode: exclusion;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .brand {
            font-family: 'Syncopate', sans-serif;
            font-weight: 700;
            font-size: clamp(16px, 4vw, 24px);
            letter-spacing: 2px;
            pointer-events: auto;
            text-decoration: none;
            color: white;
        }

        .page-indicator {
            font-family: 'Syncopate', sans-serif;
            font-size: 12px;
            color: var(--c-accent);
            letter-spacing: 2px;
            border: 1px solid var(--c-accent);
            padding: 5px 15px;
            border-radius: 20px;
        }

        /* --- PROJECT TITLES --- */
        .project-meta-container {
            position: absolute;
            bottom: 100px;
            left: 30px;
            pointer-events: none;
            z-index: 12;
            mix-blend-mode: normal;
        }

        .project-id {
            color: var(--c-accent);
            font-size: 14px;
            letter-spacing: 2px;
            margin-bottom: 10px;
            display: block;
            font-family: 'Syncopate', sans-serif;
        }

        .project-title {
            font-family: 'Syncopate', sans-serif;
            font-weight: 700;
            font-size: clamp(40px, 8vw, 80px);
            line-height: 0.9;
            text-transform: uppercase;
            color: transparent;
            -webkit-text-stroke: 1px rgba(255,255,255,0.8);
            margin-bottom: 20px;
            transform: translateY(20px);
            opacity: 0;
            transition: all 0.5s ease;
        }
        
        .project-title.active {
            opacity: 1;
            transform: translateY(0);
        }

        .project-tags {
            display: flex;
            gap: 10px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease 0.1s;
        }
        .project-title.active + .project-tags {
            opacity: 1;
            transform: translateY(0);
        }

        .tag {
            font-size: 12px;
            border: 1px solid rgba(255,255,255,0.3);
            padding: 5px 10px;
            border-radius: 100px;
            text-transform: uppercase;
            letter-spacing: 1px;
            background: rgba(0,0,0,0.5);
        }

        /* --- CANVAS --- */
        #webgl {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 1;
            cursor: grab;
        }
        #webgl:active { cursor: grabbing; }

        /* --- NAVIGATION --- */
        .back-btn {
            pointer-events: auto;
            color: white;
            text-decoration: none;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 2px;
            display: flex;
            align-items: center;
            gap: 10px;
            opacity: 0.7;
            transition: opacity 0.3s;
        }
        .back-btn:hover { opacity: 1; }
        .back-btn::before { content: '‚Üê'; font-size: 16px; }

        /* --- LOADING OVERLAY --- */
        #loader {
            position: fixed;
            inset: 0;
            background: #000;
            z-index: 100;
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--c-accent);
            font-family: 'Syncopate';
            font-weight: 700;
            font-size: clamp(20px, 5vw, 40px);
            transition: opacity 0.5s ease;
        }
    </style>
</head>
<body>

    <div id="loader">LOADING WORKS...</div>

    <canvas id="webgl"></canvas>

    <div id="ui-layer">
        <header>
            <a href="index.html" class="back-btn">Home</a>
            <div class="page-indicator">SELECTED WORKS</div>
        </header>

        <div class="project-meta-container">
            <span class="project-id" id="ui-id">01 / 03</span>
            <h1 class="project-title active" id="ui-title">THE ZAPWASH</h1>
            <div class="project-tags" id="ui-tags">
                <span class="tag">Shopify</span>
                <span class="tag">Branding</span>
                <span class="tag">SEO</span>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

    <script>
        // DATA: YOUR PROJECTS
        // I'm using placeholder colors/images because I can't load external files without CORS.
        // In a real site, replace 'color' with 'texture' loading.
        const PROJECTS = [
            {
                title: "THE ZAPWASH",
                id: "01 / 03",
                tags: ["Shopify", "Full Stack", "Business"],
                color: 0x00f3ff, // Cyan
                img: "https://images.unsplash.com/photo-1517672651691-24622a91b550?q=80&w=1000&auto=format&fit=crop"
            },
            {
                title: "CHINKULU",
                id: "02 / 03",
                tags: ["Fashion", "Identity", "Strategy"],
                color: 0xff0055, // Pink
                img: "https://images.unsplash.com/photo-1529139574466-a302d2774d75?q=80&w=1000&auto=format&fit=crop"
            },
            {
                title: "VINTHAPADALU",
                id: "03 / 03",
                tags: ["Community", "Literature", "Content"],
                color: 0xffd700, // Gold
                img: "https://images.unsplash.com/photo-1481627834876-b7833e8f5570?q=80&w=1000&auto=format&fit=crop"
            }
        ];

        class WorksApp {
            constructor() {
                this.canvas = document.querySelector('#webgl');
                this.width = window.innerWidth;
                this.height = window.innerHeight;
                
                this.scroll = 0;
                this.scrollTarget = 0;
                this.currentIdx = 0;
                
                this.initThree();
                this.initPlanes();
                this.addEvents();
                this.animate();

                // Remove Loader
                setTimeout(() => {
                    document.getElementById('loader').style.opacity = '0';
                    setTimeout(() => document.getElementById('loader').remove(), 500);
                }, 1000);
            }

            initThree() {
                this.scene = new THREE.Scene();
                this.camera = new THREE.PerspectiveCamera(70, this.width / this.height, 0.1, 100);
                this.camera.position.z = 5;

                this.renderer = new THREE.WebGLRenderer({
                    canvas: this.canvas,
                    alpha: true,
                    antialias: true
                });
                this.renderer.setSize(this.width, this.height);
                this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            }

            initPlanes() {
                this.group = new THREE.Group();
                this.scene.add(this.group);
                
                this.planes = [];
                const geometry = new THREE.PlaneBufferGeometry(3, 4, 32, 32); // High segments for distortion

                // SHADER MATERIAL
                // This creates the "Bending" effect based on scroll speed
                const materialBase = new THREE.ShaderMaterial({
                    uniforms: {
                        uTexture: { value: null }, // In real version, load textures here
                        uColor: { value: new THREE.Color('#fff') },
                        uSpeed: { value: 0 },
                        uTime: { value: 0 }
                    },
                    vertexShader: `
                        uniform float uSpeed;
                        uniform float uTime;
                        varying vec2 vUv;
                        
                        void main() {
                            vUv = uv;
                            vec3 pos = position;
                            
                            // BENDING EFFECT
                            // The faster you scroll (uSpeed), the more it bends
                            // Only bend the z-axis based on y-position
                            
                            float bend = sin(uv.y * 3.14159) * uSpeed * 0.5;
                            pos.z += bend;
                            
                            // Slight wave
                            pos.z += sin(pos.x * 2.0 + uTime) * 0.05;

                            gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);
                        }
                    `,
                    fragmentShader: `
                        uniform vec3 uColor;
                        uniform sampler2D uTexture;
                        varying vec2 vUv;
                        
                        void main() {
                            // Simple color placeholder since we can't do CORS textures easily in single file
                            // In production, use: texture2D(uTexture, vUv);
                            
                            float border = step(0.05, vUv.x) * step(0.05, vUv.y) * step(vUv.x, 0.95) * step(vUv.y, 0.95);
                            vec3 color = mix(uColor * 0.5, uColor, border);
                            
                            // Scanline effect
                            float scan = sin(vUv.y * 100.0) * 0.1;
                            
                            gl_FragColor = vec4(color + scan, 0.8);
                        }
                    `,
                    transparent: true,
                    side: THREE.DoubleSide
                });

                // CREATE 3 PLANES (One for each project)
                PROJECTS.forEach((proj, i) => {
                    const mat = materialBase.clone();
                    mat.uniforms.uColor.value = new THREE.Color(proj.color);
                    
                    const mesh = new THREE.Mesh(geometry, mat);
                    
                    // Space them out horizontally
                    mesh.position.x = i * 4; 
                    
                    this.group.add(mesh);
                    this.planes.push({ mesh, mat });
                });
            }

            addEvents() {
                let isDragging = false;
                let startX = 0;
                
                // TOUCH / MOUSE LOGIC
                const onStart = (x) => {
                    isDragging = true;
                    startX = x;
                    this.canvas.style.cursor = 'grabbing';
                };
                
                const onMove = (x) => {
                    if(!isDragging) return;
                    const diff = (x - startX) * 0.01; // Sensitivity
                    this.scrollTarget += diff;
                    startX = x;
                };
                
                const onEnd = () => {
                    isDragging = false;
                    this.canvas.style.cursor = 'grab';
                    
                    // SNAP LOGIC (Optional: Snap to nearest project)
                    // let snap = Math.round(this.scrollTarget / 4) * 4;
                    // gsap.to(this, { scrollTarget: snap, duration: 0.5 });
                };

                // Mouse
                window.addEventListener('mousedown', e => onStart(e.clientX));
                window.addEventListener('mousemove', e => onMove(e.clientX));
                window.addEventListener('mouseup', onEnd);
                
                // Touch
                window.addEventListener('touchstart', e => onStart(e.touches[0].clientX));
                window.addEventListener('touchmove', e => onMove(e.touches[0].clientX));
                window.addEventListener('touchend', onEnd);
                
                // Resize
                window.addEventListener('resize', () => {
                    this.width = window.innerWidth;
                    this.height = window.innerHeight;
                    this.camera.aspect = this.width / this.height;
                    this.camera.updateProjectionMatrix();
                    this.renderer.setSize(this.width, this.height);
                });
            }

            updateUI() {
                // Calculate which project is centered
                // We shift the world left, so negative scroll position relates to positive index
                // Each plane is 4 units apart.
                const centerIdx = Math.round(Math.abs(this.scroll) / 4) % PROJECTS.length;
                
                // Handle negative scrolling loop logic roughly for UI
                let safeIdx = Math.abs(Math.round(this.scroll / 4)) % PROJECTS.length;
                // Reverse index because dragging left moves forward in array
                if (this.scroll > 0) safeIdx = (PROJECTS.length - safeIdx) % PROJECTS.length;

                if(safeIdx !== this.currentIdx) {
                    this.currentIdx = safeIdx;
                    this.changeText(PROJECTS[safeIdx]);
                }
            }

            changeText(data) {
                const title = document.getElementById('ui-title');
                const id = document.getElementById('ui-id');
                const tags = document.getElementById('ui-tags');

                // Animate Out
                title.classList.remove('active');
                tags.style.opacity = '0';
                tags.style.transform = 'translateY(20px)';

                setTimeout(() => {
                    // Update Content
                    title.innerText = data.title;
                    id.innerText = data.id;
                    
                    // Update Tags
                    tags.innerHTML = '';
                    data.tags.forEach(t => {
                        const span = document.createElement('span');
                        span.className = 'tag';
                        span.innerText = t;
                        tags.appendChild(span);
                    });

                    // Animate In
                    title.classList.add('active');
                    tags.style.opacity = '1';
                    tags.style.transform = 'translateY(0)';
                }, 400);
            }

            animate() {
                requestAnimationFrame(this.animate.bind(this));

                // LERP: Smooth Scroll
                this.scroll += (this.scrollTarget - this.scroll) * 0.1;
                
                // Calculate Speed for Distortion (difference between target and current)
                const speed = (this.scrollTarget - this.scroll) * 2.0;

                // Move Group
                this.group.position.x = this.scroll * 2; // Speed multiplier

                // Infinite Scroll Logic (Teleport planes)
                // If a plane moves too far left, move it to the right end of the line
                this.planes.forEach((obj, i) => {
                    const worldX = obj.mesh.position.x + this.group.position.x;
                    const totalWidth = PROJECTS.length * 4;
                    
                    if(worldX < -6) {
                         obj.mesh.position.x += totalWidth;
                    }
                    if(worldX > 6 + (totalWidth - 4)) {
                         obj.mesh.position.x -= totalWidth;
                    }

                    // Update Uniforms
                    obj.mat.uniforms.uSpeed.value = speed;
                    obj.mat.uniforms.uTime.value += 0.05;
                });

                this.updateUI();
                this.renderer.render(this.scene, this.camera);
            }
        }

        new WorksApp();
    </script>
</body>
</html>
